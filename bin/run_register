#!/usr/bin/env bash

echo "Running prefect register ${*}"

args="--project ${1}"

if [ -z "${2}" ];
then
  args="${args} -p ${2}"
fi
if [ -z "${3}" ];
then
  args="${args} -m ${3}"
fi
if [ -z "${4}" ];
then
  args="${args} -j ${4}"
fi
if [ -z "${5}" ];
then
  args="${args} -n ${5}"
fi
if [ -z "${6}" ];
then
  args="${args} -l ${6}"
fi

prefect_result=$(prefect register "${args}")
exit_code=$?

echo "::set-output name=prefect-output::${prefect_result}"
exit $exit_code